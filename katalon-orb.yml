version: 2.1
description: Run katalon studio test using cirlce-ci 

orbs:
  codecov: circleci/codecov-clojure@0.0.4
executors:
      katalon_orb_executor:
        parameters:
          version:
            type: string
            default: "7.0"
        docker:
          - image: katalonstudio/katalon:<<parameters.version>>
commands:
      katalon_command:
        parameters:
          katalon_param:
            type: string
            default: '-browserType="Chrome" -retry=0 -statusDelay=15 -testSuitePath="Test Suites/TS_RegressionTest"'
        steps:
          - run: katalon-execute.sh <<parameters.katalon_param>>
jobs:
      katjob:
          executor: katalon_orb_executor
          steps:
            - checkout
            - katalon_command
            - codecov/upload:
                  path: ./report/*
workflows:
  build:
    jobs:
      - katalonstudio/katjob:
          version: "7.0"
          katalon_param: '-browserType="Chrome" -retry=0 -statusDelay=15 -testSuitePath="Test Suites/TS_RegressionTest"'
